# ============================================================================
# VaxTalk Assistant - Environment Configuration
# ============================================================================
# Copy this file to .env and customize it for your setup:
#   cp .env.example .env
#
# Then edit .env with your actual values.
# Get your Google API key from: https://aistudio.google.com/app/apikey
# ============================================================================

# ============================================================================
# API KEYS
# ============================================================================
# Your Google AI Studio API key (required)
GOOGLE_API_KEY=your_google_api_key_here
# API key for OpenRouter models (temporarily mandatory, required by sentiment analysis)
OPENROUTER_API_KEY=your_openrouter_api_key_here

# ============================================================================
# Model Configuration
# ============================================================================
# You can use different Gemini models for different agents
# There are connectors to other model providers as well.

OPENROUTER_CHAT_URL="https://openrouter.ai/api/v1/chat/completions"
OPENROUTER_EMBED_URL="https://openrouter.ai/api/v1/embeddings"

MODEL_RAG=gemini-2.5-flash-lite
MODEL_AGGREGATOR=openrouter/x-ai/grok-4.1-fast
MODEL_SAFETY_CHECK=gemini-2.5-flash-lite
MODEL_REFINER=gemini-2.5-flash-lite

MODEL_SENTIMENT=gemini-2.5-flash-lite
MODEL_SENTIMENT_EMBEDDING=google/gemini-embedding-001
MODEL_SENTIMENT_LLM=mistralai/ministral-8b

# ============================================================================
# Sentiment Analysis Configuration
# ============================================================================

# Weights for LLM + embedding fusion in sentiment analysis (should sum to 1.0)
SENTIMENT_W_LLM=0.7    # Weight for LLM predictions (default: 0.7)
SENTIMENT_W_EMB=0.3    # Weight for embedding similarity (default: 0.3)

# Path to sentiment phrases JSON (relative to project root)
# This file powers the hybrid sentiment embeddings cache
SENTIMENT_PHRASES_FILE=sentiment/sentiment_phrases.json

# ============================================================================
# Paths & Data Sources
# ============================================================================
# Path to your PDF documents folder (relative to project root)
DOC_FOLDER_PATH=docs

# Starting URL for web crawling (leave empty to skip web crawling)
# Example: https://www.serviziterritoriali-asstmilano.it/servizi/vaccinazioni/
DOC_WEB_URL_ROOT=https://www.serviziterritoriali-asstmilano.it/servizi/vaccinazioni/

# Cache directory for embeddings and processed documents
# Default: cache
CACHE_DIR=cache

# ============================================================================
# RAG Configuration (tune for performance vs quality)
# ============================================================================
# Max number of web pages to crawl
RAG_MAX_PAGES=100

# Maximum crawl depth from root URL (higher = more pages, slower)
RAG_MAX_DEPTH=5

# Number of words per document chunk (larger = more context, fewer chunks)
RAG_CHUNK_SIZE=800

# Number of overlapping words between consecutive chunks (prevents context loss)
RAG_CHUNK_OVERLAP=200

# Number of top similar chunks to retrieve for each query
RAG_RETRIEVAL_K=5

# ============================================================================
# Database Configuration (optional - defaults work for most cases)
# ============================================================================
# Async database driver for SQLite
SQL_ASYNC_DRIVER=aiosqlite

# Database filename (stored in CACHE_DIR)
# Example: vaxtalk_sessions.db, sessions.db
DB_NAME=vaxtalk_sessions.db

# ============================================================================
# API Retry Configuration (for handling rate limits and transient errors)
# ============================================================================
# Number of retry attempts for failed API calls
RETRY_ATTEMPTS=3

# Initial delay in seconds before first retry (uses exponential backoff)
RETRY_INITIAL_DELAY=1

# HTTP status codes that trigger a retry (comma-separated)
# 429=Too Many Requests, 500=Internal Server Error, 503=Service Unavailable, 504=Gateway Timeout
RETRY_HTTP_STATUS_CODES=429,500,503,504
